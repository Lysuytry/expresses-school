{"version":3,"sources":["../../../src/api/score/score.middleware.js"],"names":["Joi","objectId","createScoreValidator","object","keys","exam","string","required","student","result","array","items","subject","subjectName","socre","number","with","updateScoreValidator","validator","req","schema","body","validate","validateCreatingScore","res","next","error","fail","message","validateUpdatingScore"],"mappings":";;;;;;;AAAA;;;;AACA;;;;;;AAEAA,cAAIC,QAAJ,GAAe,2BAASD,aAAT,CAAf;;AAEA,MAAME,uBAAuBF,cAAIG,MAAJ,GAAaC,IAAb,CAAkB;AAC7CC,QAAML,cAAIM,MAAJ,GAAaC,QAAb,EADuC;AAE7CC,WAASR,cAAIC,QAAJ,GAAeM,QAAf,EAFoC;AAG7CE,UAAQT,cAAIU,KAAJ,GAAYC,KAAZ,CAAkBX,cAAIG,MAAJ,GAAaC,IAAb,CACxB;AACEQ,aAASZ,cAAIC,QAAJ,GAAeM,QAAf,EADX;AAEEM,iBAAab,cAAIM,MAAJ,GAAaC,QAAb,EAFf;AAGEO,WAAOd,cAAIe,MAAJ;AAHT,GADwB,EAMxBC,IANwB,CAMnB,SANmB,EAMR,OANQ,EAMCA,IAND,CAMM,SANN,EAMiB,aANjB,CAAlB;AAHqC,CAAlB,CAA7B;;AAYA,MAAMC,uBAAuBjB,cAAIG,MAAJ,GAAaC,IAAb,CAAkB;AAC7CC,QAAML,cAAIM,MAAJ,EADuC;AAE7CE,WAASR,cAAIC,QAAJ,EAFoC;AAG7CQ,UAAQT,cAAIU,KAAJ,GAAYC,KAAZ,CAAkBX,cAAIG,MAAJ,GAAaC,IAAb,CACxB;AACEQ,aAASZ,cAAIC,QAAJ,EADX;AAEEY,iBAAab,cAAIM,MAAJ,EAFf;AAGEQ,WAAOd,cAAIe,MAAJ;AAHT,GADwB,EAMxBC,IANwB,CAMnB,SANmB,EAMR,OANQ,EAMCA,IAND,CAMM,SANN,EAMiB,aANjB,CAAlB;AAHqC,CAAlB,CAA7B;;AAYA,MAAME,YAAY,CAACC,GAAD,EAAMC,MAAN,KAAiB;AACjC,QAAM,EAACf,IAAD,EAAOG,OAAP,EAAgBC,MAAhB,KAA0BU,IAAIE,IAApC;AACA,SAAOrB,cAAIsB,QAAJ,CAAa,EAACjB,IAAD,EAAOG,OAAP,EAAgBC,MAAhB,EAAb,EAAsCW,MAAtC,CAAP;AACD,CAHD;;AAKO,MAAMG,wDAAwB,CAACJ,GAAD,EAAMK,GAAN,EAAWC,IAAX,KAAoB;AACvD,MAAG;AACD,UAAMC,QAAQR,UAAUC,GAAV,EAAejB,oBAAf,CAAd;AACAwB,UAAMA,KAAN,KAAgB,IAAhB,GAAuBD,MAAvB,GAAgCD,IAAIG,IAAJ,CAASD,MAAMA,KAAN,CAAYE,OAArB,CAAhC;AACD,GAHD,CAGE,OAAMF,KAAN,EAAY;AACZF,QAAIG,IAAJ,CAASD,MAAMA,KAAf;AACD;AACF,CAPM;;AASA,MAAMG,wDAAwB,CAACV,GAAD,EAAMK,GAAN,EAAWC,IAAX,KAAoB;AACvD,MAAG;AACD,UAAMC,QAAQR,UAAUC,GAAV,EAAeF,oBAAf,CAAd;AACAS,UAAMA,KAAN,KAAgB,IAAhB,GAAuBD,MAAvB,GAAgCD,IAAIG,IAAJ,CAASD,MAAMA,KAAN,CAAYE,OAArB,CAAhC;AACD,GAHD,CAGE,OAAMF,KAAN,EAAY;AACZF,QAAIG,IAAJ,CAASD,KAAT;AACD;AACF,CAPM","file":"score.middleware.js","sourcesContent":["import Joi from 'joi';\nimport objectid from 'joi-objectid';\n\nJoi.objectId = objectid(Joi);\n\nconst createScoreValidator = Joi.object().keys({\n  exam: Joi.string().required(),\n  student: Joi.objectId().required(),\n  result: Joi.array().items(Joi.object().keys(\n    {\n      subject: Joi.objectId().required(),\n      subjectName: Joi.string().required(),\n      socre: Joi.number()\n    }\n  ).with('subject', 'score').with('subject', 'subjectName'))\n});\n\nconst updateScoreValidator = Joi.object().keys({\n  exam: Joi.string(),\n  student: Joi.objectId(),\n  result: Joi.array().items(Joi.object().keys(\n    {\n      subject: Joi.objectId(),\n      subjectName: Joi.string(),\n      socre: Joi.number()\n    }\n  ).with('subject', 'score').with('subject', 'subjectName'))\n});\n\nconst validator = (req, schema) => {\n  const {exam, student, result} = req.body;\n  return Joi.validate({exam, student, result}, schema);\n};\n\nexport const validateCreatingScore = (req, res, next) => {\n  try{\n    const error = validator(req, createScoreValidator);\n    error.error === null ? next() : res.fail(error.error.message);\n  } catch(error){\n    res.fail(error.error);\n  }\n};\n\nexport const validateUpdatingScore = (req, res, next) => {\n  try{\n    const error = validator(req, updateScoreValidator);\n    error.error === null ? next() : res.fail(error.error.message);\n  } catch(error){\n    res.fail(error);\n  }\n};\n"]}