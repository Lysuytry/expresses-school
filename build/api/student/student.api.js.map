{"version":3,"sources":["../../../src/api/student/student.api.js"],"names":["getStudentList","req","res","limit","skip","query","find","count","students","amount","Promise","all","Student","aggregate","total","options","success","error","fail","createStudent","first","last","gender","birthday","email","telephone","subjects","body","student","result","save","getStudentById","id","params","status","findOne","_id","updateStudentById","data","conditions","$set","updateOne","console","log","deleteStudentById","message","fakeStudent","fakerStudent"],"mappings":";;;;;;;AAAA;;;;AACA;;AACA;;;;AAEO,MAAMA,0CAAiB,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAChD,MAAG;AACD,UAAM,EAACC,KAAD,EAAQC,IAAR,KAAgBH,IAAII,KAA1B;AACA;AACA,UAAM,CAACC,IAAD,EAAOC,KAAP,IAAgB,kCAAiBN,IAAII,KAArB,CAAtB;AACA,UAAM,CAACG,QAAD,EAAWC,MAAX,IAAqB,MAAMC,QAAQC,GAAR,CAAY,CAACC,kBAAQC,SAAR,CAAkBP,IAAlB,CAAD,EAA0BM,kBAAQC,SAAR,CAAkBN,KAAlB,CAA1B,CAAZ,CAAjC;AACA,UAAMO,QAAQL,OAAO,CAAP,EAAUK,KAAxB;AACA,UAAMC,UAAU,EAACZ,KAAD,EAAQC,IAAR,EAAcU,KAAd,EAAhB;AACAZ,QAAIc,OAAJ,CAAYR,QAAZ,EAAsBO,OAAtB;AACD,GARD,CAQE,OAAOE,KAAP,EAAc;AACdf,QAAIgB,IAAJ,CAASD,KAAT;AACD;AACF,CAZM;;AAcA,MAAME,wCAAgB,OAAOlB,GAAP,EAAYC,GAAZ,KAAoB;AAC/C,MAAG;AACD;AACA,UAAM,EAACkB,KAAD,EAAQC,IAAR,EAAcC,MAAd,EAAsBC,QAAtB,EAAgCC,KAAhC,EAAuCC,SAAvC,EAAkDC,QAAlD,KAA8DzB,IAAI0B,IAAxE;AACA,UAAMC,UAAU,IAAIhB,iBAAJ,CAAY,EAACQ,KAAD,EAAQC,IAAR,EAAcC,MAAd,EAAsBC,QAAtB,EAAgCC,KAAhC,EAAuCC,SAAvC,EAAkDC,QAAlD,EAAZ,CAAhB;AACA,UAAMG,SAAS,MAAMD,QAAQE,IAAR,EAArB;AACA5B,QAAIc,OAAJ,CAAYa,MAAZ;AACD,GAND,CAME,OAAOZ,KAAP,EAAc;AACdf,QAAIgB,IAAJ,CAASD,KAAT;AACD;AACF,CAVM;;AAYA,MAAMc,0CAAiB,OAAO9B,GAAP,EAAYC,GAAZ,KAAoB;AAChD,MAAG;;AAED,UAAM,EAAE8B,EAAF,KAAS/B,IAAIgC,MAAnB;AACA,UAAM,EAAEC,MAAF,KAAajC,IAAII,KAAvB;AACA,UAAMuB,UAAU,MAAMhB,kBAAQuB,OAAR,CAAgB,EAACC,KAAKJ,EAAN,EAAUE,MAAV,EAAhB,CAAtB;AACAN,cAAU1B,IAAIc,OAAJ,CAAYY,OAAZ,CAAV,GAAiC1B,IAAIc,OAAJ,CAAY,EAAZ,CAAjC;AACD,GAND,CAME,OAAMC,KAAN,EAAY;AACZf,QAAIgB,IAAJ,CAASD,KAAT;AACD;AACF,CAVM;;AAYA,MAAMoB,gDAAoB,OAAOpC,GAAP,EAAYC,GAAZ,KAAoB;AACnD,MAAG;AACD,UAAMoC,OAAOrC,IAAI0B,IAAjB;AACA,UAAM,EAACK,EAAD,KAAO/B,IAAIgC,MAAjB;AACA,UAAM,EAACC,MAAD,KAAWjC,IAAII,KAArB;AACA,UAAMkC,aAAY,CAAC,EAACH,KAAKJ,EAAN,EAAUE,MAAV,EAAD,EAAoB,EAACM,MAAMF,IAAP,EAApB,CAAlB;AACA,UAAMT,SAAS,MAAMjB,kBAAQ6B,SAAR,CAAkB,GAAGF,UAArB,CAArB;AACAG,YAAQC,GAAR,CAAYd,MAAZ;AACA3B,QAAIc,OAAJ,CAAY,uBAAZ;AACD,GARD,CAQE,OAAMC,KAAN,EAAY;AACZf,QAAIgB,IAAJ,CAASD,KAAT;AACD;AACF,CAZM;;AAcA,MAAM2B,gDAAoB,OAAO3C,GAAP,EAAYC,GAAZ,KAAoB;AACnD,MAAG;AACD,UAAM,EAAC8B,EAAD,KAAO/B,IAAIgC,MAAjB;AACA,UAAM,EAACC,MAAD,KAAWjC,IAAII,KAArB;AACA,UAAMkC,aAAa,CAAC,EAACH,KAAKJ,EAAN,EAAUE,MAAV,EAAD,EAAoB,EAACM,MAAM,EAACN,QAAQ,UAAT,EAAP,EAApB,CAAnB;AACA,UAAMtB,kBAAQ6B,SAAR,CAAkB,GAAGF,UAArB,CAAN;AACArC,QAAIc,OAAJ,CAAY,sBAAZ;AACD,GAND,CAME,OAAMC,KAAN,EAAY;AACZf,QAAIgB,IAAJ,CAASD,MAAM4B,OAAf;AACD;AACF,CAVM;;AAYA,MAAMC,oCAAc,OAAO7C,GAAP,EAAYC,GAAZ,KAAoB;AAC7C,MAAG;AACD,UAAM0B,UAAU,IAAIhB,iBAAJ,CAAYmC,kBAAZ,CAAhB;AACA,UAAMnB,QAAQE,IAAR,EAAN;AACA5B,QAAIc,OAAJ,CAAY,IAAZ;AACD,GAJD,CAIC,OAAMC,KAAN,EAAY;AACXf,QAAIgB,IAAJ,CAASD,KAAT;AACD;AACF,CARM","file":"student.api.js","sourcesContent":["import Student from '../../models/student';\nimport {fakerStudent} from '../../common/dump';\nimport {fliterAlgorithms} from '../../common/algorithms';\n\nexport const getStudentList = async (req, res) => {\n  try{\n    const {limit, skip} = req.query;\n    // ./common/algorithms.js\n    const [find, count] = fliterAlgorithms(req.query);\n    const [students, amount] = await Promise.all([Student.aggregate(find), Student.aggregate(count)]);\n    const total = amount[0].total;\n    const options = {limit, skip, total};\n    res.success(students, options);\n  } catch( error ){\n    res.fail(error);\n  }\n};\n\nexport const createStudent = async (req, res) => {\n  try{\n    //year-month-day\n    const {first, last, gender, birthday, email, telephone, subjects} = req.body;\n    const student = new Student({first, last, gender, birthday, email, telephone, subjects});\n    const result = await student.save();\n    res.success(result);\n  } catch( error ){\n    res.fail(error);\n  }\n};\n\nexport const getStudentById = async (req, res) => {\n  try{\n\n    const { id } = req.params;\n    const { status } = req.query;\n    const student = await Student.findOne({_id: id, status});\n    student ? res.success(student) : res.success({});\n  } catch(error){\n    res.fail(error);\n  }\n};\n\nexport const updateStudentById = async (req, res) => {\n  try{\n    const data = req.body;\n    const {id} = req.params;\n    const {status} = req.query;\n    const conditions =[{_id: id, status}, {$set: data}];\n    const result = await Student.updateOne(...conditions);\n    console.log(result);\n    res.success('Successfully updated.');\n  } catch(error){\n    res.fail(error);\n  }\n};\n\nexport const deleteStudentById = async (req, res) => {\n  try{\n    const {id} = req.params;\n    const {status} = req.query;\n    const conditions = [{_id: id, status}, {$set: {status: 'inactive'}}];\n    await Student.updateOne(...conditions);\n    res.success('Succesfully deleted.');\n  } catch(error){\n    res.fail(error.message);\n  }\n};\n\nexport const fakeStudent = async (req, res) => {\n  try{\n    const student = new Student(fakerStudent);\n    await student.save();\n    res.success('ss');\n  }catch(error){\n    res.fail(error);\n  }\n};\n"]}